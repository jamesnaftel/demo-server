dependencies:
  build:
    - go:1.14.1

build_targets:
  - name: default
    tags:
      os: linux
    container:
      image: yourbase/yb_ubuntu:18.04-nonroot
    environment:
      - SKIPPER_IGNORE=ls
    commands:
      - ls
      - echo $YB_CUSTOMER_ORG
      - echo $SKIPPER_IGNORE
      - env
      - go get
      - go build
      - go test ./...

  - name: mac
    tags:
      os: linux

    commands:
      - ls
      - echo $YB_CUSTOMER_ORG
      - echo $SKIPPER_IGNORE
      - go get
      - go build
      - go test ./...

  - name: deploy
    tags:
      os: linux

    commands:
      - go get
      - go build
      - go test ./...
      # yb package ...
ci:
  builds:
    - name: default
      build_target: default
      when: branch is 'master' OR action is 'pull_request'


package:
  docker:
    base_image: alpine
    image: demo-server
    working_dir: /
    exec: /demo-server
  artifacts:
    - demo-server
